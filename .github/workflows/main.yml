name: Compress Images
on:
  push:
    paths:
      - 'assets/photos/**' # Only runs when you add/change files in your photos folder
  workflow_dispatch:      # Allows you to run it manually from the Actions tab

jobs:
  build:
    name: calibreapp/image-actions
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4

- name: Compress Images
        uses: calibreapp/image-actions@main
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Fixed this line
          jpegQuality: '80'
          pngQuality: '80'
          webpQuality: '80'
          ignorePaths: 'node_modules/**'

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          title: "Auto-compressed images"
          branch: "compressed-images"
          commit-message: "Compressed images to improve page load speed"
          body: "This PR was automatically generated by the Image Actions workflow."
